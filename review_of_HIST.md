# Introduction

股票市场是现实世界中最赚钱的投资渠道之一。为了通过投资来追求高收益，股票趋势预测作为许多复杂投资策略的基本组成部分，近年来越来越受到人们的关注。许多现有的工作[1,32,36]假设不同股票的价格彼此独立，并仅基于与每只股票相关的信息（例如历史股票价格和交易量的时间序列）来构建预测模型（例如，开盘价、收盘价、最高价和成交量）。

但在实践中，当不同股票同时和某些概念相关时，其价格走势往往会高度相关。这些概念的信息通常获取于网络上公开的企业信息，并且可以分为部门、行业、业务等多种维度。例如，随着信息技术的快速发展，大部分高科技概念下的股票都呈现出类似的牛市趋势。再比如，许多与医药概念相关的上市公司在COVID-19大流行爆发后，股价出现了大幅上涨。图1展示了一些股票示例及其相应的预定义概念。最近的许多研究通过识别股票概念中的有价值的信息，将目光转向在股票趋势预测中利用这些信息。例如，一些简单的方法[33]直接使用预定义的股票概念作为线性预测模型的输入特征。此外，其他一些[13,17,23,27]使用相同的预定义概念来形成两只股票之间的关系，并利用图神经网络（GNN）（其边缘由概念关系定义）来构建更准确的股票趋势预测模型。

![image-20240305142922484](C:\Users\ADL\AppData\Roaming\Typora\typora-user-images\企业和预定义概念.png)

尽管最近的这些研究揭示了股票概念在促进股票趋势预测方面的潜力，但它们仍然受到一些限制，限制了它们充分利用股票概念的价值。首先，在使用预定义概念作为股票之间的连接构建 GNN 模型时，大多数先前的研究都假设这些连接是固定的，因此通过它们的信息传播遵循相同的模式。然而，在真实的金融市场中，一只股票可能会产生与各种概念的动态相关度。例如，如图 1 所示，亚马逊有两个预定义的概念，并且与微软和微软共享相同的业务概念“云计算”，同时与 eBay共享另一个概念“电子商务”。显然，在COVID-19大流行造成的封锁期间，亚马逊股价的上涨趋势主要是由于其与“电子商务”增长1的概念联系，而不是“云计算”。然而，大多数现有的基于 GNN 的方法忽视了通过各种概念来区分信息传播。

此外，由于大多数现有研究仅利用人类专家预先定义的概念，因此他们会遗漏一些隐藏的概念。甚而一些新兴的重要概念也可能无法及时纳入建模中。与此同时，一些最近上市的公司可能无法从预定义的概念中受益，直到相应的概念联系得到补充。例如，一家个人防护设备公司可能会因为一场大流行病的突然爆发而无意中与一家电子商务公司共享信息和类似的未来趋势（代表与大流行病相关的公司的隐藏概念），但在大流行病之后将失去这种相关性。

为了解决这些限制，我们提出了一种新颖的基于图的框架（HIST）来挖掘股票趋势预测的面向概念的共享信息。我们HIST的设计主要遵循以下两个原则：

- 为了区分一只股票传播到具有不同预定义概念的相关股票的股票信息，我们通过联合建模相关度并聚合相应股票的信息来直接学习各种概念的动态表示。具体来说，我们构建了一个股票概念二部图，以正确提取预定义概念的动态表示，并将其传播到具有相似表示的股票，无论预定义概念是否涵盖该股票。
- 为了发现隐藏的概念和相应的概念表示，我们首先在股票概念二分图上引入双残差架构[30]，以在过滤掉预定义概念的共享信息后提取每个股票的剩余信息。随后，根据股票的剩余信息，设计了一种简单而有效的图算法来动态检测每个时间步的隐藏概念并构建其隐藏概念的表示。

在通过挖掘出的动态隐藏概念进行信息传播后，我们通过进一步过滤掉股票间共有的动态隐藏概念信息来提取每只股票的个体信息。最后，我们同时利用预定义概念的共享信息、隐藏概念的共享信息以及每只股票的个体信息来预测股价走势。

我们根据真实世界的股票数据评估我们的框架，实验结果表明，我们的框架在各种评估指标方面可以优于一些baseline。此外，我们使用一种简单但广泛使用的交易策略来模拟股票投资，结果表明我们的框架可以实现比所有baseline更高的投资回报。我们还进行了对框架中不同组件的影响的研究分析，并将挖掘的隐藏概念可视化，以进一步揭示 HIST 的优势。

本文的主要贡献包括：

- 我们提出了一个新的框架来挖掘股票的共享信息，包括预定义概念和隐藏概念的共享信息。我们挖掘的共享信息可以反映具有相同性的股票未来趋势的价值线索
- 我们提出的框架可以通过同时利用预定义和隐藏概念的动态共享信息以及每只股票的个体信息来提高股票趋势预测性能。
- 通过我们的框架，我们可以发现股票的一些重要且有价值的隐藏概念。
- 我们对真实数据进行了实验评估和投资模拟，结果验证了我们的 HIST 框架的有效性。

# RELATED WORK

股票走势预测因其在股票投资中的重要作用而受到越来越多的关注。本节将介绍两类具有代表性的股票走势预测方法：技术分析和事件驱动的股票走势预测方法。

## Technical Analysis

技术分析[11]根据历史时间序列的市场数据（例如交易价格和交易量）来预测股票走势。它的目的是发现可以用来预测未来的现有交易模式。我们可以将技术分析方法进一步分为单一股票方法和交叉股票方法。单股方法仅利用每只股票的信息来预测股票走势，跨股票方法在预测股价走势时考虑了股票之间的交叉关系。

### Single-stock Methods.

对于单一股票方法，自回归（AR）[21]和ARIMA[2]模型是这个方向最广泛使用的模型，它们都适用于线性和平稳时间序列。然而，股票价格的非线性和非平稳性质限制了 AR 和 ARIMA 模型的适用性。随着近年来深度学习的快速发展，一些研究[32, 36]尝试应用深度神经网络来捕捉市场趋势的复杂模式。为了进一步模拟时间序列中的长期依赖性，循环神经网络（RNN），特别是长短期记忆（LSTM）网络[15]，也被应用于金融预测中[1,3,14,34]。具体来说，[45]提出了一种新的状态频率记忆（SFM）循环网络来发现用于股票价格走势预测的多频率交易模式； [20]提出了一种具有高阶马尔可夫随机场（MRF）的多任务循环神经网络来预测股票价格变动方向； [12]利用对抗性训练来模拟模型训练过程中的随机性。然而，每只股票都不是孤立的；单只股票的方法无法利用股票之间的跨股票相互作用来捕获更多信息以进行股票趋势预测。

### Cross-stock Methods.

为了挖掘跨股票共享信息并提高股票趋势预测性能，许多跨股票方法[6,13,17,27]利用了图神经网络来捕捉不同股票之间的关系。 [6]和[13]利用图卷积网络（GCN）分别捕获股票的股东关系和行业关系。 [17]提出了一种用于股票预测的分层注意力网络（HATS），它使用关系数据进行股票市场预测。然而，这些现有的跨股票方法不能正确利用预定义概念的共享信息，因为它们使用固定关系来聚合信息，而忽略了股票与预定义概念之间的动态相关性。此外，他们还忽视了隐藏概念的宝贵共享信息，限制了他们的股票趋势预测表现。

### Event-driven Stock Trend Forecasting

事件驱动的股票走势预测是股票走势预测方法的另一类，旨在挖掘各种来源的事件信息来预测股价走势。事件信息的来源包括新闻[8,10,16,28,37,41]，社交媒体[35,40,42,43,46]和讨论区[22,29,47]。这些方法可以从事件信息中发现控制股价走势的隐含规则。然而，事件驱动方法高度依赖事件数据。稀疏且不规则的事件日期会降低事件驱动的股票趋势预测模型的灵活性和性能。